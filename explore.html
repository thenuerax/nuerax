<!DOCTYPE html>
<html lang="en" class="bg-[#1C1F22] text-[#F5F7FA]">
<head>
  <meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>Nuerax — Explore</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <style>
    html,body { margin:0; padding:0; width:100%; height:100%; }
    body {
      background-color: #1C1F22;
      background-image:
        radial-gradient(circle at 20% 20%, rgba(0,255,255,0.05) 0%, transparent 70%),
        radial-gradient(circle at 80% 40%, rgba(255,0,255,0.05) 0%, transparent 70%);
    }
  </style>
</head>
<body class="pt-24 px-6">

  <!-- Nav -->
  <nav class="fixed top-0 left-0 w-full flex justify-between p-6 bg-[#1C1F22]/80 backdrop-blur-md">
    <a href="index.html" class="text-2xl font-bold">Nuerax</a>
    <button id="authBtn" class="border border-cyan-400 px-4 py-1 rounded-xl">Log In</button>
  </nav>

  <!-- News Feed -->
  <h2 class="text-2xl font-semibold mb-4">Latest AI News</h2>
  <div id="news-container" class="space-y-6 text-gray-400">Loading news…</div>

  <script>
    const supabase = supabase.createClient(
      'https://qiiozzvsfpnhoxaamftf.supabase.co',
      'YOUR_SUPABASE_ANON_KEY'
    );
    const authBtn = document.getElementById('authBtn');
    supabase.auth.onAuthStateChange((_, s) => {
      if (s) {
        authBtn.textContent = '@' + s.user.user_metadata.username;
        authBtn.onclick = () => location.href = 'profile.html';
      } else {
        authBtn.textContent = 'Log In';
        authBtn.onclick = () => location.href = 'login.html';
      }
    });
    (async () => {
      const { data:{ session } } = await supabase.auth.getSession();
      if (!session) return location.replace('login.html');
      authBtn.textContent = '@' + session.user.user_metadata.username;
      authBtn.onclick = () => location.href = 'profile.html';
    })();

    async function loadNews(){
      try {
        const res = await fetch(`/api/news?company=ai`);
        const articles = await res.json();
        const container = document.getElementById('news-container');
        container.innerHTML = '';
        articles.forEach(a => {
          const card = document.createElement('div');
          card.className = 'bg-[#2A2D31] p-4 rounded-xl';
          card.innerHTML = `
            <p class="text-sm text-gray-400">${new Date(a.publishedAt).toLocaleDateString()}</p>
            <h3 class="font-medium">${a.title}</h3>
            <p class="text-gray-400">${a.description || ''}</p>
            <a href="${a.url}" target="_blank" class="text-cyan-400 underline text-sm">Read more →</a>
          `;
          container.appendChild(card);
        });
      } catch {
        document.getElementById('news-container').textContent = 'Error loading news.';
      }
    }
    loadNews();
  </script>
</body>
</html>
