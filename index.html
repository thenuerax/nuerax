<script>
    const newsContainer = document.getElementById('news-container');
    const filterButtons = document.querySelectorAll('.filter-btn');
  
    function getHoursAgo(dateString) {
      const hours = Math.floor((Date.now() - new Date(dateString)) / (1000 * 60 * 60));
      return hours < 1 ? 'Just now' : `${hours} hour${hours !== 1 ? 's' : ''} ago`;
    }
  
    function getCompanyLogo(sourceName) {
      const logos = {
        'OpenAI': 'https://cdn.jsdelivr.net/gh/devicons/devicon/icons/openai/openai-original.svg',
        'Meta': 'https://upload.wikimedia.org/wikipedia/commons/0/05/Meta_Platforms_Logo.svg',
        'Google': 'https://upload.wikimedia.org/wikipedia/commons/2/2f/Google_2015_logo.svg',
        'Nvidia': 'https://upload.wikimedia.org/wikipedia/en/2/21/Nvidia_logo.svg',
        'Microsoft': 'https://upload.wikimedia.org/wikipedia/commons/4/44/Microsoft_logo.svg',
        'Amazon': 'https://upload.wikimedia.org/wikipedia/commons/a/a9/Amazon_logo.svg',
      };
  
      // Basic match ‚Äî could improve with fuzzy logic later
      for (const name in logos) {
        if (sourceName.toLowerCase().includes(name.toLowerCase())) {
          return logos[name];
        }
      }
      return null;
    }
  
    async function fetchNueraxNews(filter = '') {
      try {
        const companyQuery = filter || 'ai';
        const res = await fetch(`/api/news?company=${encodeURIComponent(companyQuery)}`);
        const articles = await res.json();
  
        console.log('üß™ Articles from API:', articles);
  
        newsContainer.innerHTML = '';
  
        if (!articles.length) {
          newsContainer.innerHTML = '<p class="text-[#A1A6AD]">No news articles found.</p>';
          return;
        }
  
        articles.forEach(article => {
          const timeAgo = getHoursAgo(article.publishedAt);
          const logoUrl = getCompanyLogo(article.source.name);
  
          const card = document.createElement('div');
          card.className = 'bg-[#1A1D21] p-5 rounded-xl mb-6 shadow-lg hover:shadow-cyan-500/10 transform transition hover:-translate-y-1';
  
          card.innerHTML = `
            <div class="flex items-center gap-2 mb-1 text-sm text-[#A1A6AD]">
              <span>${timeAgo}</span> ‚Ä¢ <span>${article.source.name}</span>
              ${logoUrl ? `<img src="${logoUrl}" alt="${article.source.name}" class="w-4 h-4">` : ''}
            </div>
            <h3 class="text-lg font-medium text-[#F5F7FA] mb-2">${article.title}</h3>
            <p class="text-[#A1A6AD] text-sm mb-2">${article.description || ''}</p>
            <a href="${article.url}" target="_blank" class="text-[#00FFFF] text-sm underline">Read full article ‚Üí</a>
          `;
  
          newsContainer.appendChild(card);
        });
      } catch (err) {
        console.error('‚ùå Error fetching news:', err);
        newsContainer.innerHTML = '<p class="text-red-500">Failed to load news. Try again later.</p>';
      }
    }
  
    filterButtons.forEach(button => {
      button.addEventListener('click', () => {
        const company = button.getAttribute('data-company');
        fetchNueraxNews(company);
      });
    });
  
    fetchNueraxNews();
  </script>
  